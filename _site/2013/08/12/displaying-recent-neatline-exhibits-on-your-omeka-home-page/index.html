<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Displaying Recent Neatline Exhibits on your Omeka Home Page</title>
<script src="https://cdn.levelaccess.net/accessjs/YW1wX3V2YTExMDA/access.js" type="text/javascript"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Neatline allows scholars, students, and curators to tell stories with maps and timelines.">
<link rel="canonical" href="http://localhost:4000/2013/08/12/displaying-recent-neatline-exhibits-on-your-omeka-home-page/">

<link rel="icon" type="image/png" href="http://localhost:4000/assets/images/favicon.png" >
<link rel="apple-touch-icon" type="image/png" href="http://localhost:4000/assets/images/apple-touch-icon.png">

<!-- Style sheets -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<!-- <link href="//fonts.googleapis.com/css?family=Crimson+Text:400,600,400italic,600italic|Cabin:400,600,400italic" rel="stylesheet" type="text/css" />
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"> -->

<!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/carousel.css"> -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/style.css">


<!-- Feeds and Pingbacks -->
<link rel="alternate" type="application/rss+xml" title="Neatline" href=" http://localhost:4000/feed.xml">

<!-- Modernizr and Friends -->
<script src="http://localhost:4000/assets/js/modernizr.min.js"></script>
<script>
    Modernizr.load([
        {
            test: Modernizr.mq(),
            nope: [
                'http://localhost:4000/assets/js/respond.min.js',
                'http://localhost:4000/assets/js/selectivizr.min.js'
            ]
        }
    ]);
    (function() {
        var cx = '009145345920904867543:1jiuohixchs';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
    })();
</script>



  </head>
  
  <body>

    <header role="banner">
    <nav class="navbar-light bg-light">
      <div class="topnav">
            <a href="/http://localhost:4000" title="Neatline">
              <img class="logo" src="http://localhost:4000/assets/images/neatline-logo-rgb.png" alt="Neatline"/>
            </a>  
          <ul class="nav navigation">
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/about/">About</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Documentation
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                  <a class="dropdown-item" href="http://localhost:4000/docs/">Neatline for Omeka Classic</a>
                  <a class="dropdown-item" href="#">Neatline for Omeka S</a>
                </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href=http://localhost:4000/demos/>Demos</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/plugins/">Plugins</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="http://localhost:4000/news/">Blog</a>
            </li>
            <li class="nav-item">
              <a href="http://localhost:4000/publications/" class="nav-link">Publications</a>
            </li>
            <li class="nav-item">
              <a href="http://localhost:4000/credits/" class="nav-link">Credits</a>
            </li>
          </ul>
          <div id="custom_search">
              <gcse:searchbox-only resultsUrl="/results/"></gcse:searchbox-only>
          </div>

        </div>
      </nav>
    
</header>

    <div class="wrapper">
    <main id="main" class="main-content" role="main" >
      <div class="post">

  <header class="post-header">
    <h1>Displaying Recent Neatline Exhibits on your Omeka Home Page</h1>
    <p class="meta">Aug 12, 2013 • Jeremy Boggs</p>
  </header>

  <article class="post-content">
  <p><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc&amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator&amp;rft.type=&amp;rft.format=text&amp;rft.title=Displaying+Recent+Neatline+Exhibits+on+your+Omeka+Home+Page&amp;rft.source=Scholars%26%23039%3B+Lab&amp;rft.date=2013-08-12&amp;rft.identifier=http%3A%2F%2Fwww.scholarslab.org%2Fresearch-and-development%2Fdisplaying-recent-neatline-exhibits-on-your-omeka-home-page%2F&amp;rft.language=English&amp;rft.subject=Research+and+Development&amp;rft.aulast=Boggs&amp;rft.aufirst=Jeremy"></span> 
The charismatic <a href="http://www.elotroalex.com/">Alex Gil</a> submitted a feature request to Neatline asking to be able to browse <a href="https://github.com/scholarslab/Neatline/issues/211">Neatline exhibits on your Omeka home page</a>. Turns out you can already <a href="http://omeka.org/codex/Managing_Navigation_2.0#Choose_a_Homepage">specify which page you want as your home page in Omeka 2.0</a>, so that helped with Alex’s original query. But as we discussed the issue, Alex also wondered about putting a list of recent Neatline exhibits on the home page, much the same way Omeka already does with recent items. While we’re not sure yet about putting this kind of thing in the plugin itself, I mentioned that it’s fairly easy to do in your own them using one of Omeka’s hooks, and promised him a blog post explaining more. Here’s me making good on that promise.</p>

<p>In case you didn’t know, Omeka has plenty of ways for developers to add new content to an Omeka site or filter existing content using hooks and filters, respectively. To use them, you first need to write a function that adds or changes content to your preference, then you pass that function to the relevant hook or filter in Omeka. Some dummy code to illustrate:</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function my_custom_function() {
  echo 'Hello world!';
}

add_plugin_hook('hook_name', 'my_custom_function');

</pre>

<p>You could put this kind of code anywhere that Omeka could run it, particularly a new plugin or your activated theme’s <code class="highlighter-rouge">custom.php</code> file. (An Omeka theme’s <code class="highlighter-rouge">custom.php</code> file is a great place to put some custom code for your Omeka site, without having to go to the trouble of creating and activating a plugin.)</p>

<p>In our case, we want to append some new content to the home page of an Omeka site, so we’ll need to find a hook to let us do that. Fortunately, we have one available—<code class="highlighter-rouge">public_home</code>—so let’s use that to display some recent Neatline exhibits.</p>

<p>(Keep in mind that the following code should work in Omeka 2.0 and Neatline 2.0; you can take a similar approach for earlier versions of each, but some of the functions would be different.)</p>

<p>First, we’ll need to create a <code class="highlighter-rouge">custom.php</code> file in your current active theme, if one doesn’t already exist. (If it does exist, we’ll use that one.) Make sure the file is in the root of your theme: <code class="highlighter-rouge">omeka/themes/your-theme/custom.php</code>.</p>

<p>Next we’ll need to write a function that gets a certain number of Neatline exhibits and lists them out, and put that in our <code class="highlighter-rouge">custom.php</code> file. We’ll name our function <code class="highlighter-rouge">display_recent_neatline_exhibits</code>, and put all our goodies in there. Let’s create the function:</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {

}

</pre>

<p>After we’ve created the function, we’ll go ahead and pass that function to the <code class="highlighter-rouge">public_home</code> hook:</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {

}

add_plugin_hook('public_home', 'display_recent_neatline_exhibits');
</pre>

<p>We still shouldn’t see any changes on the home page, since our function isn’t actually doing anything. But you shouldn’t get any errors on the page either. If you do, make sure you have every curly brace and semicolon and all the other characters right; PHP is quite dramatic about syntax errors.</p>

<p>Now lets add some stuff to our function to get some recent Neatline exhibits. First, let’s define a variable <code class="highlighter-rouge">$html</code> and set that equal to an empty string. In the end, we’ll echo the value of <code class="highlighter-rouge">$html</code>, so we want it equal to at least something, in case you actually don’t have any Neatline exhibits to display.</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {
    $html = '';

    echo $html;
}

add_plugin_hook('public_home', 'display_recent_neatline_exhibits');
</pre>

<p>Next we’ll create a variable, <code class="highlighter-rouge">$neatlineExhibits</code>, and assign it to the results of a query using Omeka’s <code class="highlighter-rouge">get_records</code> function. The <a href="http://omeka.readthedocs.org/en/latest/Reference/libraries/globals/get_records.html"><code class="highlighter-rouge">get_records</code> function</a> takes three arguments: the type of record, an array of query parameters, and number to limit results. We’ll query for ‘NeatlineExhibit’ record type, make sure that the <code class="highlighter-rouge">recent</code> parameter is <code class="highlighter-rouge">true</code>, and limit our results to five:</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {
    $html = '';

    // Get our recent Neatline exhibits, limited to five.
    $neatlineExhibits = get_records('NeatlineExhibit', array('recent' =&gt; true), 5);

    echo $html;
}

add_plugin_hook('public_home', 'display_recent_neatline_exhibits');
</pre>

<p>Now we’ll set the results in <code class="highlighter-rouge">$neatlineExhibits</code> for a record loop, and check to see if in fact we have exhibits to display in a PHP <code class="highlighter-rouge">if</code> statement:</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {
    $html = '';

    // Get our recent Neatline exhibits, limited to five.
    $neatlineExhibits = get_records('NeatlineExhibit', array('recent' =&gt; true), 5);

    // Set them for the loop.
    set_loop_records('NeatlineExhibit', $neatlineExhibits);
 
    // If we have any to loop, we'll append to $html.
    if (has_loop_records('NeatlineExhibit')) {

    }

    echo $html;
}

add_plugin_hook('public_home', 'display_recent_neatline_exhibits');
</pre>

<p>Inside our <code class="highlighter-rouge">if</code> statement, we’ll update the value of <code class="highlighter-rouge">$html</code> so that, instead of echoing an empty string, it echos some HTML that includes links to each of our recent Neatline exhibits. Remember that this will only get printed if we actually have Neatline exhibits in the database, otherwise we’ll just return an empty string.</p>

<pre class="brush: php; title: ; notranslate">&lt;?php

function display_recent_neatline_exhibits() {
    $html = '';

    // Get our recent Neatline exhibits, limited to five.
    $neatlineExhibits = get_records('NeatlineExhibit', array('recent' =&gt; true), 5);

    // Set them for the loop.
    set_loop_records('NeatlineExhibit', $neatlineExhibits);
 
    // If we have any to loop, we'll append to $html.
    if (has_loop_records('NeatlineExhibit')) {
        $html .= '&lt;ul&gt;';
        
        foreach (loop('NeatlineExhibit') as $exhibit) {
            $html .= '&lt;li&gt;'
                   . nl_getExhibitLink(
                         $exhibit,
                         'show',
                         metadata($exhibit, 'title'),
                         array('class' =&gt; 'neatline')
                     )
                   . '&lt;/li&gt;';
        }

        $html .= '&lt;/ul&gt;';
    }

    echo $html;
}

add_plugin_hook('public_home', 'display_recent_neatline_exhibits');
</pre>

<p>As you can see, we append an opening unordered list tag, <code class="highlighter-rouge">&lt;ul&gt;</code> to <code class="highlighter-rouge">$html</code>. (Using <code class="highlighter-rouge">.=</code> in PHP lets us append additional strings onto an existing variable.) Then, we use Omeka’s <code class="highlighter-rouge">loop</code> function to loop through our set of Neatline exhibits. Inside that loop, we once again adding something to the value of <code class="highlighter-rouge">$html</code>: A list item wrapping a link to a the current Neatline exhibit in the loop. To help us make that link, we’ll use a function provided by the Neatline plugin: <code class="highlighter-rouge">nl_getExhibitLink</code>. We’re passing values for four arguments: The exhibit object (defined in <code class="highlighter-rouge">$exhibit</code> in the foreach loop); the <code class="highlighter-rouge">action</code> or route you want the link to take; the text of the link (here we’ve used Omeka’s <code class="highlighter-rouge">metadata</code> function to give us the title of the exhibit); and an array of attributes for the link (we’ve added a <code class="highlighter-rouge">class</code> attribute equal to ‘neatline’). Then we end with a closing list item tag.</p>

<p>And that should do it. You can see a version more or less the same as what I demonstrate here in a <a href="https://gist.github.com/clioweb/6178723">public gist</a> I published earlier in the week. If you’d like to display a recent list of Neatline exhibits on your Omeka home page, just grab this code, and put it in your theme’s <code class="highlighter-rouge">custom.php</code> template.</p>


  </article>

</div>
    </main>
    </div>

    <footer role="contentinfo">
      
<ul class="navigation">
    <li class="list-group-item">
        Neatline is a project of the <a href="http://www.scholarslab.org/">Scholars' Lab</a> at the University of Virginia Library. It has benefited from the generous support of the <a href="http://lib.virginia.edu">UVa Library</a>, the <a href="http://neh.gov">National Endowment for the Humanities</a>, the <a href="http://imls.gov">Institute of Museum and Library Services</a>, and the <a href="http://loc.gov">Library of Congress</a>.
    </li>
    <li class="list-group-item"><a rel="license" class="license" href="http://creativecommons.org/licenses/by/3.0/">CC-BY 3.0</a></li>
    <li class="list-group-item"><a href="https://forum.omeka.org/">Contact Us</a></li>
    <li class="list-group-item">
        <a href="http://scholarslab.org" class="align-self-center ml-3" id="slab-link">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" width="438.94" height="87.75" viewBox="0 0 438.94 87.75" enable-background="new 0 0 438.938 87.75" xml:space="preserve">
          <path d="M29.33 63.06c0 12.25-7.7 20.45-23.11 24.62l-5.13-11c4.75-1.37 8.21-2.8 10.36-4.29 3.36-2.37 5.04-5.47 5.04-9.33 0-2.92-1.43-6.49-4.28-10.72 -2.6-3.85-5.2-7.74-7.8-11.65 -2.85-5.03-4.28-9.95-4.28-14.73 0-6.15 2.54-11.71 7.61-16.69 4.63-4.66 10.27-7.74 16.92-9.23l3.8 11.8c-10.33 2.8-15.49 7.49-15.49 14.08 0 3.5 1.4 7.5 4.3 11.84 2.6 3.8 5.2 7.6 7.8 11.4C27.91 54 29.3 58.6 29.3 63.06z"/>
          <path d="M61.16 85.1c-3.6 1.11-6.19 1.67-7.77 1.67 -7.2 0-12.8-3.4-16.81-10.22 -4.01-6.81-6.02-16.38-6.02-28.7 0-12.32 2.01-21.89 6.02-28.7 4.01-6.81 9.61-10.22 16.81-10.22 1.58 0 4.2 0.6 7.8 1.67l-3.22 9.1c-1.58-0.56-3.1-0.84-4.55-0.84 -7.58 0-11.37 9.66-11.37 29 0 19.3 3.8 29 11.4 28.98 1.45 0 2.97-0.28 4.55-0.84L61.16 85.1z"/>
          <path d="M100.15 85.93h-11.46V55.28H77.61v30.65H66.15V55.28h-3.88v-9.94h3.88V9.76h11.46v35.58h11.08V9.76h11.46V85.93z"/>
          <path d="M140.41 47.85c0 25.95-5.84 38.92-17.52 38.92 -11.74 0-17.62-12.97-17.62-38.92 0-12.57 1.1-21.83 3.32-27.77 2.71-7.43 7.49-11.15 14.3-11.15 6.57 0 11.3 3.7 14.1 11.1C139.27 26.1 140.4 35.4 140.4 47.85zM129.05 47.85c0-19.32-2.05-28.98-6.16-28.98 -4.1 0-6.15 9.66-6.15 28.98 0 19.3 2 29 6.2 28.98C126.99 76.8 129 67.2 129 47.85z"/>
          <path d="M169.45 85.93h-23.11V9.76h11.46v66.23h11.65V85.93z"/>
          <path d="M213.17 85.93h-11.94l-1.32-6.78h-10.89l-1.32 6.78h-11.94l1.52-6.78h-4.55l2.27-9.94h4.36l13.45-61.12h3.32L213.17 85.93zM198.02 69.21l-3.51-18.86 -3.69 18.86H198.02z"/>
          <path d="M248.45 83.7l-11.18 3.44 -10.61-31.21v30h-11.46V9.76h11.46c6.69 0 11.8 2.5 15.3 7.4 3.16 4.5 4.7 10.5 4.7 18.13 0 8.06-2.53 14.73-7.58 20L248.45 83.7zM234.81 35.3c0-10.4-2.72-15.6-8.15-15.6v32.6c2.4 0 4.36-1.58 5.87-4.74C234.05 44.4 234.8 40.3 234.8 35.3z"/>
          <path d="M276.04 64.94c0 10.84-6.85 18.11-20.56 21.83l-4.55-9.75c4.23-1.24 7.29-2.54 9.19-3.9 3.03-2.04 4.55-4.77 4.55-8.18 0-2.6-1.26-5.76-3.79-9.47 -2.34-3.47-4.67-6.93-7.01-10.4 -2.52-4.46-3.79-8.82-3.79-13.1 0-5.51 2.24-10.46 6.73-14.86 4.17-4.15 9.19-6.87 15.06-8.17l3.41 10.5c-9.16 2.54-13.73 6.72-13.73 12.54 0 3.1 1.2 6.6 3.7 10.5 2.33 3.3 4.7 6.7 7 10.1C274.77 56.8 276 60.9 276 64.94z"/>
          <path d="M298.87 3.7l-12.22 29.82 -6.82-2.04 6.82-31.4L298.87 3.7z"/>
          <path d="M357.1 85.93H331.15V0.47h12.79v74.31h13.17V85.93z"/>
          <path d="M401.6 85.93h-11.93l-1.33-6.78h-10.89l-1.33 6.78h-11.93l1.52-6.78h-4.55l2.27-9.94h4.36l13.45-61.12h3.31L401.6 85.93zM386.44 69.21l-3.5-18.86 -3.69 18.86H386.44z"/>
          <path d="M438.87 66.05c0 6.26-1.67 11.12-5.02 14.59 -3.54 3.53-8.62 5.29-15.25 5.29h-11.46V9.76H418.6c6.63 0 11.7 2 15.3 6.04 3.35 3.8 5 9.2 5 15.98 0 8.61-2.24 14.4-6.73 17.4C436.63 52.9 438.9 58.6 438.9 66.05zM427.79 31.78c0-8.05-3.06-12.07-9.19-12.07v25.64c3.15 0 5.48-1.04 6.96-3.11C427.04 40.2 427.8 36.7 427.8 31.78zM427.79 66.1c0-7.18-3.06-10.77-9.19-10.77v20.71C424.72 76 427.8 72.7 427.8 66.05z"/>
          </svg>
        </a>
    </li>
  </ul>

    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  
  </body>
</html>
